// This file was auto-generated by the card stub generator.
// Card effects were implemented by an agent.
// If you have any questions or feedback, reach out to @C4 in the discord.

import { PokemonCard } from '../../game/store/card/pokemon-card';
import { Stage, CardType } from '../../game/store/card/card-types';
import { StoreLike, State, PlayerType } from '../../game';
import { Effect } from '../../game/store/effects/effect';
import { WAS_ATTACK_USED } from '../../game/store/prefabs/prefabs';

export class Reuniclus extends PokemonCard {
  public stage: Stage = Stage.STAGE_2;
  public evolvesFrom: string = 'Duosion';
  public cardType: CardType = P;
  public hp: number = 90;
  public weakness = [{ type: P }];
  public retreat = [C];

  public attacks = [
    {
      name: 'Link Fusion',
      cost: [P, C],
      damage: 10,
      damageCalculation: '+' as '+',
      text: 'If Solosis is on your Bench, this attack does 30 more damage. If Duosion is on your Bench, this attack does 60 more damage. If Reuniclus is on your Bench, this attack does 90 more damage.'
    }
  ];

  public set: string = 'FCO';
  public setNumber: string = '35';
  public cardImage: string = 'assets/cardback.png';
  public name: string = 'Reuniclus';
  public fullName: string = 'Reuniclus FCO';

  public reduceEffect(store: StoreLike, state: State, effect: Effect): State {
    // Attack 1: Link Fusion
    // Ref: set-furious-fists/magmortar.ts (Twin Bursts)
    if (WAS_ATTACK_USED(effect, 0, this)) {
      const player = effect.player;
      let hasSolosis = false;
      let hasDuosion = false;
      let hasReuniclus = false;

      player.forEachPokemon(PlayerType.BOTTOM_PLAYER, (cardList, card) => {
        if (cardList !== player.active) {
          if (card.name === 'Solosis') { hasSolosis = true; }
          if (card.name === 'Duosion') { hasDuosion = true; }
          if (card.name === 'Reuniclus') { hasReuniclus = true; }
        }
      });

      if (hasSolosis) { effect.damage += 30; }
      if (hasDuosion) { effect.damage += 60; }
      if (hasReuniclus) { effect.damage += 90; }
    }

    return state;
  }
}
