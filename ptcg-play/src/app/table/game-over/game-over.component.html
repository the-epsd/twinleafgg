<div class="ptcg-game-over-overlay">
  <!-- Animated background particles -->
  <!-- <div class="ptcg-particles"></div> -->

  <!-- Top gradient section with diagonal cut -->
  <div class="ptcg-game-over-top">
    <!-- Diagonal divider -->
    <div class="ptcg-diagonal-divider"></div>

    <!-- Victory text -->
    <div class="ptcg-victory-header">
      <h1 class="ptcg-game-over-title" *ngIf="isWinner">Victory!</h1>
      <h1 class="ptcg-game-over-title" *ngIf="!isWinner && prompt.winner !== GameWinner.DRAW">Defeat</h1>
      <h1 class="ptcg-game-over-title" *ngIf="prompt.winner === GameWinner.DRAW">Draw</h1>
    </div>

    <!-- Player avatars and VS -->
    <div class="ptcg-player-avatars">
      <!-- <div class="ptcg-player-avatar player">
                    <span class="ptcg-avatar-letter">P</span>
                  </div> -->
      <span class="ptcg-player-name">{{ playerUsername }}</span>
      <span class="ptcg-vs-text">vs.</span>
      <!-- <div class="ptcg-player-avatar opponent">
                    <span class="ptcg-avatar-letter">O</span>
                  </div> -->
      <span class="ptcg-player-name">{{ opponentUsername }}</span>
    </div>
  </div>

  <!-- Main content -->
  <div class="ptcg-game-over-content">
    <!-- Battle Log button -->
    <div class="ptcg-battle-log">
      <!-- <button class="ptcg-battle-log-button">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" class="ptcg-icon">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        Battle Log
      </button> -->
    </div>

    <!-- Stats and Card grid -->
    <div class="ptcg-game-over-grid">
      <!-- Left column - Stats -->
      <div class="ptcg-stats-container">
        <div class="ptcg-stats-row">
          <span class="ptcg-stat-label">Turn order</span>
          <span class="ptcg-stat-value">Went {{wentFirst ? 'first' : 'second'}}</span>
        </div>

        <div class="ptcg-stats-row">
          <span class="ptcg-stat-label">Turns played</span>
          <span class="ptcg-stat-value">{{gameState.state.turn}}</span>
        </div>

        <div class="ptcg-stats-row">
          <span class="ptcg-stat-label">Your prizes taken</span>
          <div class="ptcg-prize-indicators">
            <div class="ptcg-prize-indicator" *ngFor="let prizeNum of prizeIndicators" 
                 [class.ptcg-prize-taken]="playerPrizesTaken >= prizeNum">{{prizeNum}}</div>
          </div>
          <!-- Show accuracy indicator when using fallback data -->
          <small *ngIf="!hasAccurateStatistics()" style="color: #888; font-size: 0.8em; margin-top: 4px;">
            (Estimated - server stats unavailable)
          </small>
        </div>

        <div class="ptcg-stats-row">
          <span class="ptcg-stat-label">Opponent's prizes taken</span>
          <div class="ptcg-prize-indicators">
            <div class="ptcg-prize-indicator" *ngFor="let prizeNum of prizeIndicators" 
                 [class.ptcg-prize-opponent-taken]="opponentPrizesTaken >= prizeNum">{{prizeNum}}</div>
          </div>
          <!-- Show accuracy indicator when using fallback data -->
          <small *ngIf="!hasAccurateStatistics()" style="color: #888; font-size: 0.8em; margin-top: 4px;">
            (Estimated - server stats unavailable)
          </small>
        </div>

        <div class="ptcg-stats-row">
          <span class="ptcg-stat-label">Your damage dealt</span>
          <span class="ptcg-stat-value">{{getDamageDisplayText(playerDamageDealt)}}</span>
          <small *ngIf="!hasAccurateDamageStats()" style="color: #888; font-size: 0.8em; margin-left: 8px;">
            ({{hasAccurateStatistics() ? 'No damage tracked' : 'Estimated'}})
          </small>
        </div>

        <div class="ptcg-stats-row">
          <span class="ptcg-stat-label">Opponent's damage dealt</span>
          <span class="ptcg-stat-value">{{getDamageDisplayText(opponentDamageDealt)}}</span>
          <small *ngIf="!hasAccurateDamageStats()" style="color: #888; font-size: 0.8em; margin-left: 8px;">
            ({{hasAccurateStatistics() ? 'No damage tracked' : 'Estimated'}})
          </small>
        </div>
      </div>

      <!-- Right column - Top Performing Pokémon -->
      <div class="ptcg-card-feature">
        <!-- Your Top Pokémon -->
        <div class="ptcg-pokemon-section" *ngIf="isWinner && prompt.winner !== GameWinner.DRAW">
          <div class="ptcg-card-title-container">
            <h3 class="ptcg-card-title">Your Top Pokémon</h3>
            <div *ngIf="topPokemon && topPokemon.damage > 0" class="ptcg-damage-badge">
              {{getPokemonDamageDisplayText(topPokemon)}}
            </div>
            <div *ngIf="!topPokemon || topPokemon.damage === 0" class="ptcg-no-damage-badge">
              {{getPokemonDamageDisplayText(topPokemon)}}
            </div>
          </div>

          <!-- Your featured card -->
          <div class="ptcg-featured-card-container ptcg-player-card">
            <div class="ptcg-card-perspective">
              <div class="ptcg-card-holder">
                <div *ngIf="topPokemon && hasValidCardImage(topPokemon)" class="ptcg-top-pokemon">
                  <ptcg-card [card]="topPokemon.card"></ptcg-card>
                </div>
                <div *ngIf="topPokemon && !hasValidCardImage(topPokemon)" class="ptcg-card-error">
                  <div class="ptcg-card-back">
                    <span class="ptcg-error-text">{{ getSafePokemonName(topPokemon) }}</span>
                  </div>
                </div>
                <div *ngIf="!topPokemon" class="ptcg-card-placeholder">
                  <div class="ptcg-card-back"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Opponent's Top Pokémon -->
        <div class="ptcg-pokemon-section" *ngIf="!isWinner && prompt.winner !== GameWinner.DRAW">
          <div class="ptcg-card-title-container">
            <h3 class="ptcg-card-title">Opponent's Top Pokémon</h3>
            <div *ngIf="opponentTopPokemon && opponentTopPokemon.damage > 0" class="ptcg-damage-badge">
              {{getPokemonDamageDisplayText(opponentTopPokemon)}}
            </div>
            <div *ngIf="!opponentTopPokemon || opponentTopPokemon.damage === 0" class="ptcg-no-damage-badge">
              {{getPokemonDamageDisplayText(opponentTopPokemon)}}
            </div>
          </div>

          <!-- Opponent's featured card -->
          <div class="ptcg-featured-card-container ptcg-opponent-card">
            <div class="ptcg-card-perspective">
              <div class="ptcg-card-holder">
                <div *ngIf="opponentTopPokemon && hasValidCardImage(opponentTopPokemon)" class="ptcg-top-pokemon">
                  <ptcg-card [card]="opponentTopPokemon.card"></ptcg-card>
                </div>
                <div *ngIf="opponentTopPokemon && !hasValidCardImage(opponentTopPokemon)" class="ptcg-card-error">
                  <div class="ptcg-card-back">
                    <span class="ptcg-error-text">{{ getSafePokemonName(opponentTopPokemon) }}</span>
                  </div>
                </div>
                <div *ngIf="!opponentTopPokemon" class="ptcg-card-placeholder">
                  <div class="ptcg-card-back"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- OK Button -->
    <div class="ptcg-actions">
      <button class="ptcg-ok-button" (click)="confirm()">OK</button>
    </div>
  </div>
</div>