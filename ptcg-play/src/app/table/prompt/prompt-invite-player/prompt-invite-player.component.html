<div class="invite-game-container">
  <!-- Compact Header -->
  <div class="invite-header">
    <div class="header-content">
      <div class="invite-title-section">
        <h2 class="invite-title" translate>PROMPT_INVITE_TITLE</h2>
        <div class="format-badge">
          <span class="format-label">{{ 'GAMES_FORMAT' | translate }}:</span>
          <span class="format-value">{{ formats[gameState.format] | translate }}</span>
        </div>
      </div>

      <!-- Minimize Button -->
      <button mat-icon-button class="minimize-button" (click)="minimize()">
        <mat-icon>keyboard_arrow_down</mat-icon>
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="invite-content">
    <!-- Loading State -->
    <div class="loading-container" *ngIf="loading">
      <div class="loading-spinner">
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
      </div>
      <p class="loading-text">Loading your decks...</p>
    </div>

    <!-- Game Message -->
    <div class="game-message" *ngIf="!loading">
      <div class="message-content">
        <mat-icon class="message-icon">info</mat-icon>
        <p [translate]="'GAME_MESSAGES.' + prompt.message"></p>
      </div>
    </div>

    <!-- Deck Selection -->
    <div class="deck-selection" *ngIf="!loading && decks.length > 0">
      <div class="selection-header">
        <h3 class="selection-title">Select Your Deck</h3>
        <div class="deck-count">{{ decks.length }} deck{{ decks.length !== 1 ? 's' : '' }} available</div>
      </div>

      <div class="deck-grid">
        <div class="deck-card" *ngFor="let deck of decks; let i = index" [class.selected]="deckId === deck.value"
          [class.disabled]="gameState.deleted" (click)="!gameState.deleted && selectDeck(deck.value)">
          <div class="deck-card-content">
            <div class="deck-artwork">
              <ptcg-archetype [class]="getDeckArchetype(deck.value)"
                style="transform: scale(2); display: flex; image-rendering: pixelated;"></ptcg-archetype>
            </div>
            <div class="deck-info">
              <div class="deck-name">{{ deck.viewValue }}</div>
            </div>
            <div class="selection-indicator" *ngIf="deckId === deck.value">
              <mat-icon>check_circle</mat-icon>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- No Decks State -->
    <div class="no-decks-container" *ngIf="!loading && decks.length === 0">
      <div class="no-decks-content">
        <div class="no-decks-icon">
          <mat-icon>deck</mat-icon>
        </div>
        <h3 class="no-decks-title" translate>PROMPT_INVITE_NO_DECK</h3>
        <p class="no-decks-description">You need to create a deck for this format before you can join a game.</p>
        <twinleaf-button [text]="'PROMPT_INVITE_GO_TO_DECKS' | translate" [icon]="'add'" (clicked)="navigateToDeck()">
        </twinleaf-button>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="invite-actions">
    <twinleaf-button [text]="'BUTTON_CANCEL' | translate" color="secondary" [disabled]="gameState.deleted"
      (clicked)="cancel()">
    </twinleaf-button>
    <twinleaf-button [text]="'BUTTON_OK' | translate" color="primary"
      [disabled]="gameState.deleted || !deckId || loading" [loading]="loading" (clicked)="confirm()">
    </twinleaf-button>
  </div>
</div>