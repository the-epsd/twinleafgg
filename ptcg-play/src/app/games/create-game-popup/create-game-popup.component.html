<!-- Header Section -->
<div class="create-game-header">
  <div class="header-content">
    <div class="title-section">
      <h2 class="create-game-title" translate>GAMES_CREATE_GAME_TITLE</h2>
    </div>
  </div>
</div>

<!-- Main Content -->
<div class="create-game-content">
  <form #form="ngForm" autocomplete="off" class="game-form">

    <!-- Format Selection -->
    <div class="form-section">
      <div class="section-header">
        <h3 class="section-title">Game Format</h3>
        <div class="section-description">Choose the format for your game</div>
      </div>

      <div class="format-selection">
        <mat-form-field class="modern-form-field">
          <mat-label translate>GAMES_FORMAT</mat-label>
          <mat-select [(value)]="settings.format" (selectionChange)="onFormatSelected($event.value)"
            [disabled]="formatLocked">
            <mat-option *ngFor="let option of formats" [value]="option.value">
              {{ option.label | translate }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Bot format explanation -->
      <div *ngIf="isInvitingBot" class="bot-format-info">
        <mat-icon>info</mat-icon>
        <span translate>GAMES_BOT_FORMAT_LOCKED</span>
      </div>
    </div>

    <!-- Deck Selection -->
    <div class="form-section">
      <div class="section-header">
        <h3 class="section-title">Your Deck</h3>
        <div class="section-description">Select a deck for this format</div>
      </div>

      <div class="deck-selection" *ngIf="formatValidDecks && formatValidDecks.length > 0">
        <div class="deck-grid">
          <div class="deck-card" *ngFor="let deck of formatValidDecks; let i = index"
            [class.selected]="deckId === deck.value" (click)="selectDeck(deck.value)">
            <div class="deck-card-content">
              <div class="deck-artwork">
                <ptcg-archetype [class]="getDeckArchetype(deck.value)"
                  style="transform: scale(2); display: flex; image-rendering: pixelated;"></ptcg-archetype>
              </div>
              <div class="deck-info">
                <div class="deck-name">{{ deck.viewValue }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="no-decks-message" *ngIf="!formatValidDecks || formatValidDecks.length === 0">
        <div class="no-decks-content">
          <mat-icon>deck</mat-icon>
          <p>No valid decks available for this format</p>
        </div>
      </div>
    </div>

    <!-- Game Settings -->
    <div class="form-section">
      <div class="section-header">
        <h3 class="section-title">Game Settings</h3>
        <div class="section-description">Configure your game preferences</div>
      </div>

      <div class="settings-grid">
        <!-- Time limit -->
        <div class="setting-item">
          <mat-form-field class="modern-form-field">
            <mat-label translate>GAMES_TIME_LIMIT</mat-label>
            <mat-select [(value)]="settings.timeLimit">
              <mat-option *ngFor="let option of timeLimits" [value]="option.value">
                {{option.viewValue | translate }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <!-- Recording (Admin only) -->
        <div class="setting-item" *ngIf="isAdmin">
          <div class="checkbox-setting">
            <mat-checkbox color="primary" name="rule1" [(ngModel)]="settings.recordingEnabled">
              {{ 'GAMES_RECORD_GAME' | translate }}
            </mat-checkbox>
          </div>
        </div>
      </div>
    </div>

    <!-- Game Rules -->
    <div class="form-section">
      <div class="section-header">
        <h3 class="section-title">Game Rules</h3>
        <div class="section-description">Customize the game rules</div>
      </div>

      <div class="rules-grid">
        <div class="rule-item">
          <mat-checkbox color="primary" name="rule2" [(ngModel)]="settings.rules.unlimitedEnergyAttachments">
            {{ 'GAMES_UNLIMITED_ENERGY' | translate }}
          </mat-checkbox>
        </div>
        <div class="rule-item">
          <mat-checkbox color="primary" name="rule3" [(ngModel)]="settings.rules.alternativeSetup">
            {{ 'GAMES_ALTERNATIVE_SETUP' | translate }}
          </mat-checkbox>
        </div>
      </div>
    </div>
  </form>
</div>

<!-- Action Buttons -->
<div class="create-game-actions">
  <button mat-raised-button class="action-button cancel-button" (click)="cancel()">
    {{ 'BUTTON_CANCEL' | translate }}
  </button>
  <button mat-raised-button class="action-button confirm-button" (click)="confirm()" [disabled]="!hasValidDeck()">
    {{ 'BUTTON_OK' | translate }}
  </button>
</div>