<div class="ptcg-match-table">
  <h3 translate>GAMES_RECENT_GAMES_TITLE</h3>

  <ptcg-content [loading]="loading">
    <!-- Match Cards Grid -->
    <div class="matches-grid">
      <div class="match-card" *ngFor="let match of matches; let i = index">
        <!-- Match Header -->
        <div class="match-card-header">
          <div class="match-date">
            <span class="date-text">{{ match.created | date: ('DATE_FORMAT' | translate) }}</span>
          </div>
          <div class="match-status"
            [class.winner]="match.winner === GameWinner.PLAYER_1 || match.winner === GameWinner.PLAYER_2">
            <span class="status-text">COMPLETED</span>
          </div>
        </div>

        <!-- Players Section -->
        <div class="players-section">
          <!-- Player 1 -->
          <div class="player-card" [class.winner]="match.winner === GameWinner.PLAYER_1">
            <div class="player-avatar">
              <ptcg-avatar [avatarFile]="users[match.player1Id]?.avatarFile || ''" class="avatar-image">
              </ptcg-avatar>
            </div>
            <div class="player-info">
              <div class="player-name">{{ users[match.player1Id]?.name || 'Unknown Player' }}</div>
              <div class="player-details">
                <span class="player-ranking">Rank {{ users[match.player1Id]?.ranking || 0 }}</span>
                <div class="player-archetype">
                  <ptcg-archetype [class]="getPlayerArchetype(match.player1Id)" class="archetype-icon"></ptcg-archetype>
                </div>
              </div>
            </div>
          </div>

          <!-- VS Divider -->
          <div class="vs-divider">
            <div class="vs-line"></div>
            <div class="vs-text">VS</div>
            <div class="vs-line"></div>
          </div>

          <!-- Player 2 -->
          <div class="player-card" [class.winner]="match.winner === GameWinner.PLAYER_2">
            <div class="player-info">
              <div class="player-name">{{ users[match.player2Id]?.name || 'Unknown Player' }}</div>
              <div class="player-details">
                <span class="player-ranking">Rank {{ users[match.player2Id]?.ranking || 0 }}</span>
                <div class="player-archetype">
                  <ptcg-archetype [class]="getPlayerArchetype(match.player2Id)" class="archetype-icon"></ptcg-archetype>
                </div>
              </div>
            </div>
            <div class="player-avatar">
              <ptcg-avatar [avatarFile]="users[match.player2Id]?.avatarFile || ''" class="avatar-image">
              </ptcg-avatar>
            </div>
          </div>
        </div>

        <!-- Match Actions -->
        <div class="match-actions">
          <twinleaf-button [text]="'BUTTON_REPLAY' | translate" [icon]="'play_arrow'" [matMenuTriggerFor]="menu">
          </twinleaf-button>
          <mat-menu #menu="matMenu" class="modern-menu">
            <button mat-menu-item [disabled]="loading" (click)="showReplay(match.matchId)">
              <mat-icon>play_arrow</mat-icon>
              <span>{{ 'BUTTON_SHOW' | translate }}</span>
            </button>
            <button mat-menu-item [disabled]="loading" (click)="saveReplay(match.matchId)">
              <mat-icon>save</mat-icon>
              <span>{{ 'BUTTON_SAVE' | translate }}</span>
            </button>
          </mat-menu>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination-section">
      <mat-paginator hidePageSize="true" [disabled]="loading" [length]="matchesTotal" [pageIndex]="pageIndex"
        [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" (page)="onPageChange($event)">
      </mat-paginator>
    </div>

    <div class="ptcg-u-padding ptcg-table-loading-failed" *ngIf="loadingFailed">
      <p translate>TABLE_ERROR_LOADING</p>
      <button mat-raised-button (click)="refresh(id)">
        {{ 'BUTTON_TRY_AGAIN' | translate }}
      </button>
    </div>
  </ptcg-content>
</div>