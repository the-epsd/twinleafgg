<div class="battle-pass-container" *ngIf="!loading">

  <!-- Main Header with Pokemon Artwork -->
  <div class="battle-pass-header">
    <div class="header-background">
      <div class="header-artwork">
        <div class="artwork-left"></div>
        <div class="artwork-right"></div>
      </div>
      <div class="header-content">
        <div class="battle-pass-logo">
          <div class="logo-text">
            <span class="scarlet-violet">TWINLEAF</span>
            <!-- <div class="logo-main">
              <span class="black-white">BLACK & WHITE</span> -->
            <!-- <div class="logo-symbols">
                <span class="bolt">BOLT</span>
                <span class="flare">FLARE</span>
              </div> -->
            <!-- </div> -->
          </div>
        </div>

        <!-- Level Progress Section -->
        <div class="level-progress-section" *ngIf="season && progress">
          <div class="level-display">
            <div class="level-number">{{ progress.level }}</div>
            <div class="level-badge">
              <div class="badge-content">
                <span class="current-xp">{{ getCurrentLevelExp() }}</span>
                <span class="separator">/</span>
                <span class="max-xp">{{ getTotalLevelExp() }}</span>
              </div>
            </div>
          </div>
          <div class="xp-progress-bar">
            <div class="progress-fill" [style.width.%]="getExpPercentage()"></div>
          </div>
        </div>

        <!-- Battle Pass Status -->
        <div class="battle-pass-status">
          <div class="status-badge">
            <span class="status-text">BATTLE PASS</span>
          </div>
          <div class="time-remaining">
            <span class="time-label">ENDS IN:</span>
            <span class="time-value">9W 6D</span>
          </div>
        </div>
      </div>
    </div>
  </div>



  <!-- Rewards Track -->
  <div class="rewards-track-section">
    <div class="rewards-track-container" #rewardsTrackContainer (wheel)="onWheelScroll($event)">
      <div class="rewards-track">
        <div class="track-level" *ngFor="let level of levels"
          [class.unlocked]="progress && progress.level >= level.level"
          [class.current]="progress && progress.level === level.level">

          <!-- Item Panel -->
          <div class="item-panel" *ngIf="level.freeReward">
            <div class="item-content">
              <div class="item-image">
                <div class="placeholder-image"></div>
              </div>
              <div class="reward-name">{{ level.freeReward.name }}</div>
            </div>
            <button class="claim-button" *ngIf="isClaimable(level.level)" (click)="claim(level.level)"
              [disabled]="claimingLevel === level.level">
              {{ claimingLevel === level.level ? 'Claiming...' : 'Claim' }}
            </button>
            <button class="claim-button admin-grant"
              *ngIf="!isClaimable(level.level) && progress?.level >= level.level && level.freeReward"
              (click)="adminGrant(level.freeReward)">
              Force Grant
            </button>
            <div class="completion-check"
              *ngIf="progress && progress.level >= level.level && progress.claimedRewards.includes(level.level)">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
              </svg>
            </div>
          </div>

          <!-- Level Rail -->
          <div class="level-rail">
            <div class="rail-line left"></div>
            <div class="rail-badge" [class.unlocked]="progress && progress.level >= level.level">
              <ng-container *ngIf="progress && progress.level >= level.level; else lockedTpl">
                <span class="level-number">{{ level.level }}</span>
              </ng-container>
              <ng-template #lockedTpl>
                <svg viewBox="0 0 24 24" fill="currentColor" class="lock-icon">
                  <path
                    d="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z" />
                </svg>
              </ng-template>
            </div>
            <div class="rail-line right"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Loading Spinner -->
<div class="loading-spinner" *ngIf="loading">
  <div class="spinner">
    <div class="spinner-ring"></div>
    <div class="spinner-ring"></div>
    <div class="spinner-ring"></div>
  </div>
</div>

<div class="no-season-container" *ngIf="!loading && !season">
  <div class="no-season-content">
    <h2>No Active Battle Pass</h2>
    <p>There is no active Battle Pass season at the moment.</p>
  </div>
</div>